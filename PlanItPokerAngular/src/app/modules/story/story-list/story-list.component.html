<div class="a-tab-navigation__wrapper">
  <div class="tabs-container">
      <button type="button" class="a-button a-button--integrated -without-label a-tab-navigation__button-left">
        <i class="a-icon a-button__icon ui-ic-left-small"></i>
      </button>
      
      <ol class="a-tab-navigation" role="tablist">
        <li class="a-tab-navigation__item" role="none">
          <button type="button" 
                  class="a-tab-navigation__tab" 
                  [class.a-tab-navigation__tab--active]="selectedTab() === 0"
                  (click)="selectedTab.set(0)">
            <span class="a-tab-navigation__tab-content">
              <span class="a-tab-navigation__label">
                Active <span class="badge">{{ storyState.activeStories().length }}</span>
              </span>
            </span>
          </button>
        </li>

        <!-- Completed Tab -->
        <li class="a-tab-navigation__item" role="none">
          <button type="button" 
                  class="a-tab-navigation__tab" 
                  [class.a-tab-navigation__tab--active]="selectedTab() === 1"
                  (click)="selectedTab.set(1)">
            <span class="a-tab-navigation__tab-content">
              <span class="a-tab-navigation__label">
                Completed <span class="badge">{{ storyState.completedStories().length }}</span>
              </span>
            </span>
          </button>
        </li>

        <!-- All Tab -->
        <li class="a-tab-navigation__item" role="none">
          <button type="button" 
                  class="a-tab-navigation__tab" 
                  [class.a-tab-navigation__tab--active]="selectedTab() === 2"
                  (click)="selectedTab.set(2)">
            <span class="a-tab-navigation__tab-content">
              <span class="a-tab-navigation__label">
                All <span class="badge">{{ storyState.stories().length }}</span>
              </span>
            </span>
          </button>
        </li>
      </ol>
      
      <button type="button" class="a-button a-button--integrated -without-label a-tab-navigation__button-right">
        <i class="a-icon a-button__icon ui-ic-right-small"></i>
      </button>
    </div>

  <!-- Add Story Button -->
  <div class="actions" *ngIf="playerRole() === 'MODERATOR'">
    <button class="a-button a-button--secondary"
            (click)="openCreateDialog()">
      <i class="a-icon a-button__icon boschicon-bosch-ic-add"></i>
      <span class="a-button__label">Add Story</span>
    </button>
  </div>
</div>
<table *ngIf="selectedTab() === 0" class="m-table" aria-label="Active Stories">
  <thead>
    <tr>
      <th>Name</th>
      <th *ngIf="playerRole() === 'MODERATOR'" class="-align-right">Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let story of filteredStories()" 
        class="clickable-row"
        (click)="playerRole() === 'MODERATOR' && handleEditStory(story)">
      <td>{{ story.name }}</td>
      <td *ngIf="playerRole() === 'MODERATOR'" class="-with-icon -align-right">
        <div class="action-buttons">
          <button type="button"
                  class="a-button a-button--tertiary -without-label"
                  aria-label="Edit story"
                  (click)="handleEditStory(story); $event.stopPropagation()">
            <i class="a-icon a-button__icon boschicon-bosch-ic-edit"></i>
          </button>
          <button type="button"
                  class="a-button a-button--tertiary -without-label"
                  aria-label="Delete story"
                  (click)="handleDeleteStory(story.id); $event.stopPropagation()">
            <i class="a-icon a-button__icon boschicon-bosch-ic-delete"></i>
          </button>
        </div>
      </td>
    </tr>
  </tbody>
</table>

<!-- Completed Stories Table -->
<table *ngIf="selectedTab() === 1" class="m-table" aria-label="Completed Stories">
  <thead>
    <tr>
      <th>Name</th>
      <th>Result</th>
      <th *ngIf="playerRole() === 'MODERATOR'" class="-align-right">Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let story of filteredStories()" class="clickable-row">
      <td>{{ story.name }}</td>
      <td [class]="'result-' + (story.finalResult?.toLowerCase() || 'none')">
        {{ story.finalResult || '-' }}
      </td>
      <td *ngIf="playerRole() === 'MODERATOR'" class="-with-icon -align-right">
        <div class="action-buttons">
          <button type="button"
                  class="a-button a-button--tertiary -without-label"
                  aria-label="View story"
                  (click)="handleEditStory(story); $event.stopPropagation()">
            <i class="a-icon a-button__icon boschicon-bosch-ic-watch-on"></i>
          </button>
          <button type="button"
                  class="a-button a-button--tertiary -without-label"
                  aria-label="Delete story"
                  (click)="handleDeleteStory(story.id); $event.stopPropagation()">
            <i class="a-icon a-button__icon boschicon-bosch-ic-delete"></i>
          </button>
        </div>
      </td>
    </tr>
  </tbody>
</table>

<!-- All Stories Table -->
<table *ngIf="selectedTab() === 2" class="m-table" aria-label="All Stories">
  <thead>
    <tr>
      <th class="status-column"></th>
      <th>Name</th>
      <th>Status</th>
      <th>Result</th>
      <th *ngIf="playerRole() === 'MODERATOR'" class="-align-right">Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let story of filteredStories()" 
        class="clickable-row"
        [class.status-active]="story.status === 'ACTIVE'"
        [class.status-completed]="story.status === 'COMPLETED'"
        (click)="playerRole() === 'MODERATOR' && handleEditStory(story)">
        <td class="status-indicator-wrapper">
          <div class="status-indicator" [class]="'status-' + story.status.toLowerCase()"></div>
        </td>
      <td>{{ story.name }}</td>
      <td>{{ story.status }}</td>
      <td [class]="'result-' + (story.finalResult?.toLowerCase() || 'none')">
        {{ story.finalResult || '-' }}
      </td>
      <td *ngIf="playerRole() === 'MODERATOR'" class="-with-icon -align-right">
        <div class="action-buttons">
          <button type="button"
                  class="a-button a-button--tertiary -without-label"
                  aria-label="Edit story"
                  (click)="handleEditStory(story); $event.stopPropagation()">
            <i class="a-icon a-button__icon boschicon-bosch-ic-watch-on"></i>
          </button>
          <button type="button"
                  class="a-button a-button--tertiary -without-label"
                  aria-label="Delete story"
                  (click)="handleDeleteStory(story.id); $event.stopPropagation()">
            <i class="a-icon a-button__icon boschicon-bosch-ic-delete"></i>
          </button>
        </div>
      </td>
    </tr>
  </tbody>
</table>